<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="
    The scDblFinder package gathers various methods for the detection and 
    handling of doublets/multiplets in single-cell sequencing data (i.e. 
    multiple cells captured within the same droplet or reaction volume). It
    includes methods formerly found in the scran package, the new fast
    and comprehensive scDblFinder method, and a reimplementation of the
    Amulet detection method for single-cell ATAC-seq.">
<title>scDblFinder • scDblFinder</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="scDblFinder">
<meta property="og:description" content="
    The scDblFinder package gathers various methods for the detection and 
    handling of doublets/multiplets in single-cell sequencing data (i.e. 
    multiple cells captured within the same droplet or reaction volume). It
    includes methods formerly found in the scran package, the new fast
    and comprehensive scDblFinder method, and a reimplementation of the
    Amulet detection method for single-cell ATAC-seq.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">scDblFinder</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.15.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="articles/scDblFinder.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/computeDoubletDensity.html">Scoring potential doublets from simulated densities</a>
    <a class="dropdown-item" href="articles/findDoubletClusters.html">Detecting clusters of doublet cells with DE analyses</a>
    <a class="dropdown-item" href="articles/introduction.html">Introduction to the scDblFinder package</a>
    <a class="dropdown-item" href="articles/recoverDoublets.html">Recovering intra-sample doublets</a>
    <a class="dropdown-item" href="articles/scATAC.html">Doublet identifiation in single-cell ATAC-seq</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/plger/scDblFinder/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="scdblfinder-">scDblFinder <img align="right" style="margin-left: 20px; margin-bottom: 10px;" src="https://raw.githubusercontent.com/plger/scDblFinder/devel/inst/docs/sticker.svg"><a class="anchor" aria-label="anchor" href="#scdblfinder-"></a>
</h1></div>
<p><a href="https://github.com/plger/scDblFinder/actions" class="external-link"><img src="https://github.com/plger/scDblFinder/workflows/R-CMD-check/badge.svg" alt="R build status"></a></p>
<p>The <code>scDblFinder</code> package gathers various methods for the detection and handling of doublets/multiplets in single-cell sequencing data (i.e. multiple cells captured within the same droplet or reaction volume), including the novel <code>scDblFinder</code> method. The methods included here are <em>complementary</em> to doublets detection via cell hashes and SNPs in multiplexed samples: while hashing/genotypes can identify doublets formed by cells of the same type (homotypic doublets) from two samples, which are often nearly undistinguishable from real cells transcriptionally (and hence generally unidentifiable through the present package), it cannot identify doublets made by cells of the same sample, even if they are heterotypic (formed by different cell types). Instead, the methods presented here are primarily geared towards the identification of heterotypic doublets, which for most purposes are also the most critical ones.</p>
<p>For a brief overview of the methods, see the <a href="https://plger.github.io/scDblFinder/articles/introduction.html">introductory vignette</a> (<code><a href="articles/introduction.html">vignette("introduction", package="scDblFinder")</a></code>). For the detailed study including comparison with alternative methods, see the <a href="https://doi.org/10.12688/f1000research.73600.2" class="external-link">paper</a>. Here, we will showcase doublet detection using the fast and comprehensive <code>scDblFinder</code> method.</p>
<p><br><br></p>
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>You may install the pakage using:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"scDblFinder"</span><span class="op">)</span></span></code></pre></div>
<p>Or, to get the very latest version,</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"plger/scDblFinder"</span><span class="op">)</span></span></code></pre></div>
<p>The latest version will not be compatible with older Bioconductor versions.</p>
<p>Note that, when not installing from git, Bioconductor does not install the latest version of packages, but (to ensure compatibility between packages) installs the version tied to your Bioconductor version. To ensure the best results, install the latest Bioconductor release. We recommend to avoid using scDblFinder from versions prior to Bioconductor 3.14, which give suboptimal results, and scATAC users will need scDblFinder version 1.13.2 or above.</p>
</div>
<div class="section level3">
<h3 id="basic-usage">Basic usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h3>
<p>Given an object <code>sce</code> of class <code>SingleCellExperiment</code> (which does not contain any empty drops, but hasn’t been further filtered), you can launch the doublet detection with:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/plger/scDblFinder" class="external-link">scDblFinder</a></span><span class="op">)</span></span>
<span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/scDblFinder.html">scDblFinder</a></span><span class="op">(</span><span class="va">sce</span><span class="op">)</span></span></code></pre></div>
<p>This will add a number of columns to the <code>colData</code> of <code>sce</code>, the most important of which are:</p>
<ul>
<li>
<code>sce$scDblFinder.score</code> : the final doublet score (the higher the more likely that the cell is a doublet)</li>
<li>
<code>sce$scDblFinder.class</code> : the classification (doublet or singlet)</li>
</ul>
<p>There are several additional columns containing further information (e.g. the most likely origin of the putative doublet), an overview of which is available in the <a href="https://plger.github.io/scDblFinder/articles/scDblFinder.html">vignette</a> (<code><a href="articles/scDblFinder.html">vignette("scDblFinder")</a></code>).</p>
</div>
<div class="section level3">
<h3 id="multiple-samples">Multiple samples<a class="anchor" aria-label="anchor" href="#multiple-samples"></a>
</h3>
<p>If you have multiple samples (understood as different cell captures, i.e. for multiplexed samples with cell hashes, rather use the batch), then it is preferable to provide <code>scDblFinder</code> with this information in order to take into consideration batch/sample-specific doublet rates. You can do this by simply providing a vector of the sample ids to the <code>samples</code> parameter of scDblFinder or, if these are stored in a column of <code>colData</code>, the name of the column. With default settings, the this will result in samples being processed separately, which appears to be faster, more robust to batch effects, and as accurate as training a single model (see the <code>multiSampleMode</code> argument for other options). In such cases, you might also consider multithreading it using the <code>BPPARAM</code> parameter. For example:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Bioconductor/BiocParallel" class="external-link">BiocParallel</a></span><span class="op">)</span></span>
<span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/scDblFinder.html">scDblFinder</a></span><span class="op">(</span><span class="va">sce</span>, samples<span class="op">=</span><span class="st">"sample_id"</span>, BPPARAM<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/MulticoreParam-class.html" class="external-link">MulticoreParam</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">sce</span><span class="op">$</span><span class="va">scDblFinder.class</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="cluster-based-detection">Cluster-based detection<a class="anchor" aria-label="anchor" href="#cluster-based-detection"></a>
</h3>
<p><code>scDblFinder</code> has two main modes for generating artificial doublets: a random one (<code>clusters=FALSE</code>, now default) and a cluster-based one (<code>clusters=TRUE</code> or providing your own clusters - the approach from previous versions). In practice, we observed that both approaches perform well (and better than alternatives). We suggest using the cluster-based approach when the datasets are segregated into clear clusters, and the random one for the rest (e.g. developmental trajectories).</p>
</div>
<div class="section level3">
<h3 id="expected-proportion-of-doublets">Expected proportion of doublets<a class="anchor" aria-label="anchor" href="#expected-proportion-of-doublets"></a>
</h3>
<p>The expected proportion of doublets has little impact on the score, but a very strong impact on where the threshold will be placed (the thresholding procedure simultaneously minimizes classification error and departure from the expected doublet rate). It is specified through the <code>dbr</code> parameter and the <code>dbr.sd</code> parameter (the latter specifies the standard deviation of <code>dbr</code>, i.e. the uncertainty in the expected doublet rate). For 10x data, the more cells you capture the higher the chance of creating a doublet, and Chromium documentation indicates a doublet rate of roughly 1% per 1000 cells captures (so with 5000 cells, (0.01*5)*5000 = 250 doublets), and the default expected doublet rate will be set to this value (with a default standard deviation of 0.015). Note however that different protocols may create considerably more doublets, and that this should be updated accordingly. If you are unsure about the doublet rate, set <code>dbr.sd=1</code> and the thresholding will be entirely based on the misclassification rates.</p>
</div>
</div>
<div class="section level2">
<h2 id="single-cell-atacseq">Single-cell ATACseq<a class="anchor" aria-label="anchor" href="#single-cell-atacseq"></a>
</h2>
<p>The <code>scDblFinder</code> method can be to single-cell ATACseq (on peak-level counts), however when doing so we recommend using the <code>aggregateFeatures=TRUE</code> parameter (see vignette).</p>
<p>In addition, the package includes a reimplementation of the Amulet method from Thibodeau et al. (2021). For more information, see the <a href="https://plger.github.io/scDblFinder/articles/scATAC.html">ATAC-related vignette</a>.</p>
<p><br><br></p>
</div>
<div class="section level2">
<h2 id="comparison-with-other-tools">Comparison with other tools<a class="anchor" aria-label="anchor" href="#comparison-with-other-tools"></a>
</h2>
<p><code>scDblFinder</code> was independently evaluated by Nan Miles Xi and Jingyi Jessica Li in the <a href="https://arxiv.org/abs/2101.08860" class="external-link">addendum</a> to their excellent <a href="https://doi.org/10.1016/j.cels.2020.11.008" class="external-link">benchmark</a>, where they write that <em>“scDblFinder achieves the highest mean AUPRC and AUROC values, and it is also the top method in terms of the precision, recall, and TNR under the 10% identification rate.”</em></p>
<p>The figure below compares some of the methods implemented in this package (in bold) with alternative methods (including the top alternative, <code>DoubletFinder</code>): <img src="https://raw.githubusercontent.com/plger/scDblFinder/devel/inst/docs/scDblFinder_comparison.png" alt="Benchmark of doublet detection methods"><strong>Figure1:</strong> Accuracy (area under the precision and recall curve) of doublet identification using alternative methods across 16 benchmark datasets from Xi and Li (2020). The colour of the dots indicates the relative ranking for the dataset, while the size and numbers indicate the actual area under the (PR) curve. For each dataset, the top method is circled in black. Methods with names in black are provided in the <code>scDblFinder</code> package. Running times are indicated on the left. On top the number of cells in each dataset is shown, and colored by the proportion of variance explained by the first two components (relative to that explained by the first 100), as a rough guide to dataset simplicity.</p>
<p><br><br></p>
<p>Rather a <b>python</b> person? You can have a look at <a href="https://doi.org/10.12688/f1000research.73600.2" class="external-link">vaeda</a>, another doublet finding method which appears to have performances close to those of scDblFinder.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://www.bioconductor.org/packages/scDblFinder" class="external-link">View on Bioconductor</a></li>
<li><a href="https://github.com/plger/scDblFinder/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/plger/scDblFinder/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing scDblFinder</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Pierre-Luc Germain <br><small class="roles"> Maintainer, author </small> <a href="https://orcid.org/0000-0003-3418-4218" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Pierre-Luc Germain.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
