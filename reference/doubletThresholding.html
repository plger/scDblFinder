<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>doubletThresholding — doubletThresholding • scDblFinder</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="doubletThresholding — doubletThresholding"><meta name="description" content="Sets the doublet scores threshold; typically called by
scDblFinder."><meta property="og:description" content="Sets the doublet scores threshold; typically called by
scDblFinder."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">scDblFinder</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.19.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/scDblFinder.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/computeDoubletDensity.html">Scoring potential doublets from simulated densities</a></li>
    <li><a class="dropdown-item" href="../articles/findDoubletClusters.html">Detecting clusters of doublet cells with DE analyses</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Introduction to the scDblFinder package</a></li>
    <li><a class="dropdown-item" href="../articles/recoverDoublets.html">Recovering intra-sample doublets</a></li>
    <li><a class="dropdown-item" href="../articles/scATAC.html">Doublet identifiation in single-cell ATAC-seq</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/plger/scDblFinder/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>doubletThresholding</h1>
      <small class="dont-index">Source: <a href="https://github.com/plger/scDblFinder/blob/devel/R/doubletThresholding.R" class="external-link"><code>R/doubletThresholding.R</code></a></small>
      <div class="d-none name"><code>doubletThresholding.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Sets the doublet scores threshold; typically called by
<code><a href="scDblFinder.html">scDblFinder</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">doubletThresholding</span><span class="op">(</span></span>
<span>  <span class="va">d</span>,</span>
<span>  dbr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dbr.sd <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dbr.per1k <span class="op">=</span> <span class="fl">0.008</span>,</span>
<span>  stringency <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  p <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auto"</span>, <span class="st">"optim"</span>, <span class="st">"dbr"</span>, <span class="st">"griffiths"</span><span class="op">)</span>,</span>
<span>  perSample <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  returnType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"threshold"</span>, <span class="st">"call"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-d">d<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>A data.frame of cell properties, with each row representing a cell, as
produced by `scDblFinder(..., returnType="table")`, or minimally containing a `score`
column.</p></dd>


<dt id="arg-dbr">dbr<a class="anchor" aria-label="anchor" href="#arg-dbr"></a></dt>
<dd><p>The expected (mean) doublet rate. If `d` contains a `cluster` column, the
doublet rate will be adjusted for homotypic doublets.</p></dd>


<dt id="arg-dbr-sd">dbr.sd<a class="anchor" aria-label="anchor" href="#arg-dbr-sd"></a></dt>
<dd><p>The standard deviation of the doublet rate, representing the
uncertainty in the estimate. Ignored if `method!="optim"`.</p></dd>


<dt id="arg-dbr-per-k">dbr.per1k<a class="anchor" aria-label="anchor" href="#arg-dbr-per-k"></a></dt>
<dd><p>The expected proportion of doublets per 1000 cells.</p></dd>


<dt id="arg-stringency">stringency<a class="anchor" aria-label="anchor" href="#arg-stringency"></a></dt>
<dd><p>A numeric value &gt;0 and &lt;1 which controls the relative weight of false
positives (i.e. real cells) and false negatives (artificial doublets) in setting the
threshold. A value of 0.5 gives equal weight to both; a higher value (e.g. 0.7) gives
higher weight to the false positives, and a lower to artificial doublets.  Ignored if
`method!="optim"`.</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>The p-value threshold determining the deviation in doublet score.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>The thresholding method to use, either 'auto' (default, automatic
selection depending on the available fields), 'optim' (optimization of
misclassification rate and deviation from expected doublet rate), 'dbr' (strictly
based on the expected doublet rate), or 'griffiths' (cluster-wise number of
median absolute deviation in doublet score).</p></dd>


<dt id="arg-persample">perSample<a class="anchor" aria-label="anchor" href="#arg-persample"></a></dt>
<dd><p>Logical; whether to perform thresholding individually for each sample.</p></dd>


<dt id="arg-returntype">returnType<a class="anchor" aria-label="anchor" href="#arg-returntype"></a></dt>
<dd><p>The type of value to return, either doublet calls (`call`) or
thresholds (`threshold`).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A vector of doublet calls if `returnType=="call"`, or a threshold (or vector
of thresholds) if `returnType=="threshold"`.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">sce</span> <span class="op">&lt;-</span> <span class="fu"><a href="mockDoubletSCE.html">mockDoubletSCE</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="scDblFinder.html">scDblFinder</a></span><span class="op">(</span><span class="va">sce</span>, verbose<span class="op">=</span><span class="cn">FALSE</span>, returnType<span class="op">=</span><span class="st">"table"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">th</span> <span class="op">&lt;-</span> <span class="fu">doubletThresholding</span><span class="op">(</span><span class="va">d</span>, dbr<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">th</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5918789</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pierre-Luc Germain.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

